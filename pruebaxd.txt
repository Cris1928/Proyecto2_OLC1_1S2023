
main inicio();

int ack(int m, int n){
    if (m == 0) {
        return n + 1;
    } else if (n == 0) {
        return ack(m - 1, 1);
    } else {
        return ack(m - 1, ack(m, n - 1));
    }
}


void inicio(){
  
    print("Ackerman de 3,0 "+ack(3,0));
    print("Ackerman de 2,8 "+ack(2,8));
    print("Ackerman de 2,1 "+ack(2,1));
}


/*
Ackerman de 3,0 5
Ackerman de 2,8 19
Ackerman de 2,1 5
*/
------------------------------------------------------------------------------------------------------
 int m =1;
if (m == 1) {
       print(m);
    } else if (m == 3) {
        print(m);
    } else if (m == 7) {
        print(m);
    } else {
        print("ninguno");
    }

----------------------------------------------------------------------------------------------------
import Errores from "../../Ast/Errores";
import Nodo from "../../Ast/Nodo";
import Controlador from "../../Controlador";
import { Expresion } from "../../Interfaces/Expresion";
import { Instruccion } from "../../Interfaces/Instruccion";
import TablaSimbolos from "../../TablaSimbolos/TablaSimbolos";
import { tipo } from "../../TablaSimbolos/Tipo";
import Break from "../SentenciasTransferencia/Break";
import Continue from "../SentenciasTransferencia/Continue";
import Retorno from "../SentenciasTransferencia/Return";

export default class Ifs implements Instruccion{

    public condicion : Expresion;
     public lista_instrucciones_ifs : Array<Instruccion>;
     public lista_instrucciones_elses : Array<Instruccion>;
     public linea : number;
     public columna : number;

     /**
      *
      */
     constructor( condicion : Expresion, lista_instrucciones_ifs : Array<Instruccion>, lista_instrucciones_elses : Array<Instruccion>, linea: number, columna: number) { 
        this.condicion = condicion;
        this.lista_instrucciones_ifs = lista_instrucciones_ifs;
        this.lista_instrucciones_elses = lista_instrucciones_elses;
        this.columna = columna;
        this.linea = linea;
     }

    ejecutar(controlador: Controlador, ts: TablaSimbolos) {
        /**
         * int x = 20;
         *  if(true){
         *     int a = 8;
         *      print(a);
         * }else{
         *       x = 30;
         * }
         * print(x); // 20
         */
        let ts_local = new TablaSimbolos(ts,ts.name);
        let valor_condicion = this.condicion.getValor(controlador,ts); //true | false

        if(this.condicion.getTipo(controlador,ts) == tipo.BOOLEANO){
            if(valor_condicion){
                for(let inst of this.lista_instrucciones_ifs){
                    let ret = inst.ejecutar(controlador,ts_local);
                    if(ret instanceof Break){
                        if(controlador.sent_ciclica){
                            console.log("aquiiiiiii");
                            return ret;
                        }else{
                            let error = new Errores("Semantico", `No se puede ejecutar la sentencia de transferencia Break dentro de la sentencia de control if.`, this.linea, this.columna);
                            controlador.errores.push(error);
                            controlador.append(` *** ERROR: Semantico, No se puede ejecutar la sentencia de transferencia Break dentro de la sentencia de control if. En la linea ${this.linea} y columna ${this.columna}`)
                        }
                    }
                    if(ret instanceof Continue){
                        if(controlador.sent_ciclica){
                            console.log("aquiiiiiii");
                            return ret;
                        }else{
                            let error = new Errores("Semantico", `No se puede ejecutar la sentencia de transferencia Continue dentro de la sentencia de control if.`, this.linea, this.columna);
                            controlador.errores.push(error);
                            controlador.append(` *** ERROR: Semantico, No se puede ejecutar la sentencia de transferencia Continue dentro de la sentencia de control if. En la linea ${this.linea} y columna ${this.columna}`)
                        }
                    }

                    if(ret instanceof Retorno){
                        console.log("aquiiiiiii");
                        return ret; 
                    }

                    if( ret != null){
                        console.log("aquiiiiiii");
                        return ret;
                    }
                }
            }else{
                /**
                 * if () {} else if(){} else { }
                 */
                for(let inst of this.lista_instrucciones_elses){
                    let ret = inst.ejecutar(controlador,ts_local);
                    if(ret instanceof Break){

                        if(controlador.sent_ciclica){
                            return ret;
                        }else{
                            //error semantico, no se puede tener un break dentro de un else 
                        }
                    }
                    if(ret instanceof Retorno){
                        return ret; 
                    }

                    if( ret != null){

                        return ret;
                    }
                }


                       /*
}else{
            if(this.listaElseIf){ 
                for(let i of this.listaElseIf){
                    const operation = i.interpretar(arbol, tabla);
                    if(operation){
                        return false;
                    }
                }
            }
            if(this.listaInsElse){
                const tablaLocal = new SymbolTable(tabla)
                for(let i of this.listaInsElse){
                    i.interpretar(arbol, tablaLocal)
                }
                return false
            }
        }


                 */






            }
        }
        return null;
    }
    recorrer(): Nodo {
        let padre = new Nodo("Instruccion","");
      
        let SI = new Nodo("IF","");
        //console.log(this.condicion)
        let condicion = this.condicion.recorrer()
     
        padre.AddHijo(SI);
        padre.AddHijo(condicion);

        let intrucicones_if = new Nodo("Intrucciones","");

        for(let ins of this.lista_instrucciones_ifs){
            console.log("if");
                console.log(ins);
            intrucicones_if.AddHijo(ins.recorrer())
        }
        
        padre.AddHijo(intrucicones_if);
        console.log(this.lista_instrucciones_elses)
        if(this.lista_instrucciones_elses.length != 0){
            let intrucicones_Else = new Nodo("Else","");
            console.log("else");
            for(let ins of this.lista_instrucciones_elses){
                console.log(ins);
                intrucicones_Else.AddHijo(ins.recorrer())
            }
            
            padre.AddHijo(intrucicones_Else);
        }


       return padre;
        
    }
}

---------------------------------------------------------------------------------

sent_if : IF PARA e PARC LLAVA instrucciones LLAVC{ $$ = new Ifs.default($3, $6, [], @1.first_line, @1.last_column); }
        | IF PARA e PARC LLAVA instrucciones LLAVC ELSE LLAVA instrucciones LLAVC { $$ = new Ifs.default($3, $6, $10, @1.first_line, @1.last_column); }
        | ELIF PARA e PARC LLAVA instrucciones LLAVC sent_else { $$ = new Ifs.default($3, $6, [], @1.first_line, @1.last_column); }
        ;

sent_else :
        ELSE LLAVA instrucciones LLAVC       { $$ = new Ifs.default(null, [], $3, @1.first_line, @1.last_column); }
        |
;

----------------------------------------------------------------------------------

sent_if : IF PARA e PARC LLAVA instrucciones LLAVC{ $$ = new Ifs.default($3, $6, [], @1.first_line, @1.last_column); }
        | ELSE IF PARA e PARC LLAVA instrucciones LLAVC { $$ = new Ifs.default($4, $7, [], @1.first_line, @1.last_column); }  
        |ELSE LLAVA instrucciones LLAVC       { $$ = new Ifs.default(null, [], $3, @1.first_line, @1.last_column); }
        ;

---------------------------------------------------------------------------------------
sent_if : SIMPLEIF
        |IF PARA e PARC LLAVA instrucciones LLAVC ELSE LLAVA instrucciones LLAVC { $$ = new Ifs.default($3, $6, $10, @1.first_line, @1.last_column); }
        |IF PARA e PARC LLAVA instrucciones LLAVC ELSEIFSINS ELSE LLAVA instrucciones LLAVC { $$ = new Ifs.default($3, $6, $11, @1.first_line, @1.last_column); }
        ;

SIMPLEIF:
        IF PARA e PARC LLAVA instrucciones LLAVC{ $$ = new Ifs.default($3, $6, [], @1.first_line, @1.last_column);}
        ;
 
ELSEIFSINS:
        ELSEIFSINS ELSE SIMPLEIF 
        | ELSE SIMPLEIF 
        ;



------------------------------------ESTE FASE DE PRUEBA-------------------------------

sent_if : SIMPLEIF  {
        $$ = {
            returnInstruction: $1.returnInstruction
        }
    }  
        |IF PARA e PARC LLAVA instrucciones LLAVC ELSE LLAVA instrucciones LLAVC { $$ = new Ifs.default($3, $6, $10, @1.first_line, @1.last_column); }
        |IF PARA e PARC LLAVA instrucciones LLAVC ELSEIFSINS ELSE LLAVA instrucciones LLAVC { console.log($6),$$ = new Ifs.default($3, $6, $11, @1.first_line, @1.last_column),console.log("adelante"),console.log($8),console.log("aqui"),console.log($8.returnInstruction[1].lista_instrucciones_ifs),console.log($3),console.log("atras")}
        ;

SIMPLEIF:
        IF PARA e PARC LLAVA instrucciones LLAVC{ $$ = {returnInstruction: new Ifs.default($3, $6, [], @1.first_line, @1.last_column) }}
        ;
 
ELSEIFSINS:
        ELSEIFSINS ELSE SIMPLEIF   {$1.returnInstruction.push($3.returnInstruction); 
                                    $$={ returnInstruction: $1.returnInstruction }}
        | ELSE SIMPLEIF  {$$={returnInstruction: [$2]}  }
        ;

